[{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2024 BIOST561FinalProject authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":[]},{"path":"/articles/BIOST561FinalProject.html","id":"introduction","dir":"Articles","previous_headings":"Warning: this is a demo package for vcovCR.glmerMod, the complete version is on the way.","what":"Introduction","title":"BIOST561FinalProject","text":"goal write function provide robust variances generalized linear mixed models fit using glmer function R.","code":"vcovCR.glmerModZY <- function(obj, cluster = NULL, type = \"classic\") {   # put some check here to ensure the input is correct   # If cluster not specified, will be set to attr(obj,\"cluster\")   if (is.null(cluster)) {     cluster <- attr(obj, \"cluster\")   }    link <- family(obj)$link    beta <- matrix(fixef(obj), ncol = 1)    np <- length(beta)    gamma <- matrix(unlist(ranef(obj)), ncol = 1)    nq <- length(gamma)    X <- model.matrix(obj,type = \"fixed\")   Z <- model.matrix(obj, type = \"random\")  # Z matrix for random effects   Y <- obj@resp$y    eta <- predict(obj, type = \"link\")   ginv_eta <- predict(obj, type = \"response\")    if (link == \"identity\"){     delta = diag(nobs(obj)) # diag matrix     deltainv = diag(1/diag(delta))# a more efficient way to get solve(delta)   }    else if (link == \"logit\"){     delta <- diag(exp(eta)/(1+exp(eta))^2)     deltainv <- diag(1/diag(delta))   }    else if (link == \"log\") {     delta <- diag(exp(eta))     deltainv <- diag(1/diag(delta))   }    P <- deltainv %*% (Y - ginv_eta) + eta   e <- matrix(P - X %*% beta, ncol = 1)   XtVX <- vcov(obj)  # model based variance   #theta <- as.data.frame(VarCorr(obj)) # This is where the problem is, when you fit different models, this is different    sigma2 <- sigma(obj)^2   lambda <- getME(obj,\"Lambda\")   R <- lambda %*% t(lambda) * sigma2    G <- ngrps(obj)[\"fcluster\"]   sum <- matrix(0, np, np)    for (g in 1:G){     grp = ctdata$fcluster == g     ng = sum(grp)      # V = Z[grp,]%*%R%*%t(Z[grp,]) + deltainv[grp,grp]%*%Sigma%*%deltainv[grp,grp]     # Vinv = solve(V)     Sigma <- sigma2 * diag(ng)     WB_A <- diag(1/diag(deltainv[grp,grp]%*%Sigma%*%deltainv[grp,grp]))      WB_U <- Z[grp,]     WB_C <- solve(R)     WB_V <- t(Z[grp,])      W <- WoodburyMatrix(A = WB_A, U = WB_U, B = WB_C, V = WB_V)     Vinv <- solve(W)      H = X[grp, ] %*% XtVX %*% t(X[grp, ]) %*% Vinv     Q = t(X[grp, ]) %*% Vinv %*% X[grp, ] %*% XtVX      # if loop, choose A, F and c based on robust variance form specified by the input 'type'     F = diag(ng)     A = diag(np)      sum = sum + A %*% t(X[grp, ]) %*% Vinv %*% t(F) %*% e[grp, ] %*% t(e[grp, ]) %*% F %*% Vinv %*% X[grp, ] %*% A   }    c = 1   robustVar <- c * XtVX %*% sum %*% XtVX   diag(robustVar)  # Return diagonal elements representing the variances }"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zihang Yu. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Yu Z (2024). BIOST561FinalProject: Package (One Line, Title Case). R package version 0.0.0.9000, https://zaynyu.github.io/BIOST561FinalProject/.","code":"@Manual{,   title = {BIOST561FinalProject: What the Package Does (One Line, Title Case)},   author = {Zihang Yu},   year = {2024},   note = {R package version 0.0.0.9000},   url = {https://zaynyu.github.io/BIOST561FinalProject/}, }"},{"path":"/index.html","id":"biost561-final-project","dir":"","previous_headings":"","what":"What the Package Does (One Line, Title Case)","title":"What the Package Does (One Line, Title Case)","text":"repository final project BIOST561 taught Prof. Kevin Lin. GitHub repository URL: https://github.com/ZAYNYU/BIOST561FinalProject PkgDown website URL: https://zaynyu.github.io/BIOST561FinalProject/","code":"─ Session info ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────  setting  value  version  R version 4.4.0 (2024-04-24 ucrt)  os       Windows 10 x64 (build 19045)  system   x86_64, mingw32  ui       RStudio  language (EN)  collate  Chinese (Simplified)_China.utf8  ctype    Chinese (Simplified)_China.utf8  tz       America/Tijuana  date     2024-06-06  rstudio  2024.04.1+748 Chocolate Cosmos (desktop)  pandoc   3.1.11 @ C:/Program Files/RStudio/resources/app/bin/quarto/bin/tools/ (via rmarkdown)  ─ Packages ───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────  package              * version    date (UTC) lib source  askpass                1.2.0      2023-09-03 [1] CRAN (R 4.4.0)  BIOST561FinalProject * 0.0.0.9000 2024-06-07 [1] local  boot                   1.3-30     2024-02-26 [2] CRAN (R 4.4.0)  brio                   1.1.5      2024-04-24 [1] CRAN (R 4.4.0)  bslib                  0.7.0      2024-03-29 [1] CRAN (R 4.4.0)  cachem                 1.1.0      2024-05-16 [1] CRAN (R 4.4.0)  callr                  3.7.6      2024-03-25 [1] CRAN (R 4.4.0)  cli                    3.6.2      2023-12-11 [1] CRAN (R 4.4.0)  clubSandwich         * 0.5.10     2023-07-20 [1] CRAN (R 4.4.0)  crayon                 1.5.2      2022-09-29 [1] CRAN (R 4.4.0)  credentials            2.0.1      2023-09-06 [1] CRAN (R 4.4.0)  curl                   5.2.1      2024-03-01 [1] CRAN (R 4.4.0)  desc                   1.4.3      2023-12-10 [1] CRAN (R 4.4.0)  devtools             * 2.4.5      2022-10-11 [1] CRAN (R 4.4.0)  digest                 0.6.35     2024-03-11 [1] CRAN (R 4.4.0)  ellipsis               0.3.2      2021-04-29 [1] CRAN (R 4.4.0)  evaluate               0.23       2023-11-01 [1] CRAN (R 4.4.0)  fansi                  1.0.6      2023-12-08 [1] CRAN (R 4.4.0)  fastmap                1.2.0      2024-05-15 [1] CRAN (R 4.4.0)  fs                     1.6.4      2024-04-25 [1] CRAN (R 4.4.0)  gert                   2.0.1      2023-12-04 [1] CRAN (R 4.4.0)  gh                     1.4.1      2024-03-28 [1] CRAN (R 4.4.0)  gitcreds               0.1.2      2022-09-08 [1] CRAN (R 4.4.0)  glue                   1.7.0      2024-01-09 [1] CRAN (R 4.4.0)  htmltools              0.5.8.1    2024-04-04 [1] CRAN (R 4.4.0)  htmlwidgets            1.6.4      2023-12-06 [1] CRAN (R 4.4.0)  httpuv                 1.6.15     2024-03-26 [1] CRAN (R 4.4.0)  httr2                  1.0.1      2024-04-01 [1] CRAN (R 4.4.0)  jquerylib              0.1.4      2021-04-26 [1] CRAN (R 4.4.0)  jsonlite               1.8.8      2023-12-04 [1] CRAN (R 4.4.0)  knitr                  1.46       2024-04-06 [1] CRAN (R 4.4.0)  later                  1.3.2      2023-12-06 [1] CRAN (R 4.4.0)  lattice                0.22-6     2024-03-20 [2] CRAN (R 4.4.0)  lifecycle              1.0.4      2023-11-07 [1] CRAN (R 4.4.0)  lme4                 * 1.1-35.3   2024-04-16 [1] CRAN (R 4.4.0)  magrittr               2.0.3      2022-03-30 [1] CRAN (R 4.4.0)  MASS                   7.3-60.2   2024-04-24 [2] local  Matrix               * 1.7-0      2024-03-22 [1] CRAN (R 4.4.0)  memoise                2.0.1      2021-11-26 [1] CRAN (R 4.4.0)  mime                   0.12       2021-09-28 [1] CRAN (R 4.4.0)  miniUI                 0.1.1.1    2018-05-18 [1] CRAN (R 4.4.0)  minqa                  1.2.7      2024-05-20 [1] CRAN (R 4.4.0)  nlme                   3.1-164    2023-11-27 [2] CRAN (R 4.4.0)  nloptr                 2.0.3      2022-05-26 [1] CRAN (R 4.4.0)  openssl                2.2.0      2024-05-16 [1] CRAN (R 4.4.0)  pillar                 1.9.0      2023-03-22 [1] CRAN (R 4.4.0)  pkgbuild               1.4.4      2024-03-17 [1] CRAN (R 4.4.0)  pkgconfig              2.0.3      2019-09-22 [1] CRAN (R 4.4.0)  pkgdown                2.0.9      2024-04-18 [1] CRAN (R 4.4.0)  pkgload                1.3.4      2024-01-16 [1] CRAN (R 4.4.0)  prettyunits            1.2.0      2023-09-24 [1] CRAN (R 4.4.0)  processx               3.8.4      2024-03-16 [1] CRAN (R 4.4.0)  profvis                0.3.8      2023-05-02 [1] CRAN (R 4.4.0)  promises               1.3.0      2024-04-05 [1] CRAN (R 4.4.0)  ps                     1.7.6      2024-01-18 [1] CRAN (R 4.4.0)  purrr                  1.0.2      2023-08-10 [1] CRAN (R 4.4.0)  R6                     2.5.1      2021-08-19 [1] CRAN (R 4.4.0)  rappdirs               0.3.3      2021-01-31 [1] CRAN (R 4.4.0)  rcmdcheck              1.4.0      2021-09-27 [1] CRAN (R 4.4.0)  Rcpp                   1.0.12     2024-01-09 [1] CRAN (R 4.4.0)  remotes                2.5.0      2024-03-17 [1] CRAN (R 4.4.0)  rlang                  1.1.3      2024-01-10 [1] CRAN (R 4.4.0)  rmarkdown              2.27       2024-05-17 [1] CRAN (R 4.4.0)  roxygen2               7.3.1      2024-01-22 [1] CRAN (R 4.4.0)  rprojroot              2.0.4      2023-11-05 [1] CRAN (R 4.4.0)  rstudioapi             0.16.0     2024-03-24 [1] CRAN (R 4.4.0)  sandwich             * 3.1-0      2023-12-11 [1] CRAN (R 4.4.0)  sass                   0.4.9      2024-03-15 [1] CRAN (R 4.4.0)  sessioninfo            1.2.2      2021-12-06 [1] CRAN (R 4.4.0)  shiny                  1.8.1.1    2024-04-02 [1] CRAN (R 4.4.0)  stringi                1.8.4      2024-05-06 [1] CRAN (R 4.4.0)  stringr                1.5.1      2023-11-14 [1] CRAN (R 4.4.0)  sys                    3.4.2      2023-05-23 [1] CRAN (R 4.4.0)  testthat               3.2.1.1    2024-04-14 [1] CRAN (R 4.4.0)  tibble                 3.2.1      2023-03-20 [1] CRAN (R 4.4.0)  urlchecker             1.0.1      2021-11-30 [1] CRAN (R 4.4.0)  usethis              * 2.2.3      2024-02-19 [1] CRAN (R 4.4.0)  utf8                   1.2.4      2023-10-22 [1] CRAN (R 4.4.0)  vctrs                  0.6.5      2023-12-01 [1] CRAN (R 4.4.0)  whisker                0.4.1      2022-12-05 [1] CRAN (R 4.4.0)  withr                  3.0.0      2024-01-16 [1] CRAN (R 4.4.0)  WoodburyMatrix       * 0.0.3      2023-06-19 [1] CRAN (R 4.4.0)  xfun                   0.44       2024-05-15 [1] CRAN (R 4.4.0)  xml2                   1.3.6      2023-12-04 [1] CRAN (R 4.4.0)  xopen                  1.0.1      2024-04-25 [1] CRAN (R 4.4.0)  xtable                 1.8-4      2019-04-21 [1] CRAN (R 4.4.0)  yaml                   2.3.8      2023-12-11 [1] CRAN (R 4.4.0)  zoo                    1.8-12     2023-04-13 [1] CRAN (R 4.4.0)   [1] C:/Users/zayny/AppData/Local/R/win-library/4.4  [2] C:/Program Files/R/R-4.4.0/library"},{"path":"/reference/vcovCR.glmerModZY.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance Covariance Computation for GLMM — vcovCR.glmerModZY","title":"Variance Covariance Computation for GLMM — vcovCR.glmerModZY","text":"Computes robust variance-covariance matrix generalized linear mixed models fitted glmer lme4 package. allows specification clustering supports different types variance estimations.","code":""},{"path":"/reference/vcovCR.glmerModZY.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance Covariance Computation for GLMM — vcovCR.glmerModZY","text":"obj glmerMod object representing fitted model. cluster Optional; vector indicating cluster structure within data. NULL, attempts retrieve cluster information attributes model object. type Character string specifying type variance-covariance matrix compute. Supported types include \"classic\", potential types depending method implementation.","code":""},{"path":"/reference/vcovCR.glmerModZY.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variance Covariance Computation for GLMM — vcovCR.glmerModZY","text":"Returns diagonal matrix computed variances fixed effect model.","code":""}]
